<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Painel da Empresa - CEASA</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-green-50 min-h-screen flex flex-col">

  <!-- Header -->
  <header class="bg-green-700 text-white p-4 flex justify-between items-center">
    <h1 class="text-xl font-bold">🌱 CEASA - Painel da Empresa</h1>
    <button onclick="logout()" class="bg-red-500 px-4 py-2 rounded-lg hover:bg-red-600 transition">
      Sair
    </button>
  </header>

  <!-- Conteúdo -->
  <main class="flex-1 container mx-auto p-6">
    <h2 class="text-2xl font-semibold mb-4">📂 Seus Arquivos</h2>

    <ul id="listaArquivos" class="space-y-2">
      <li class="text-gray-500">Carregando...</li>
    </ul>
  </main>

  <script>
    async function listarArquivos() {
      const listaEl = document.getElementById("listaArquivos");
      listaEl.innerHTML = "<li class='text-gray-500'>Carregando...</li>";

      try {
        const resposta = await fetch("/arquivos");
        if (!resposta.ok) {
          throw new Error("Erro ao buscar arquivos");
        }

        const arquivos = await resposta.json();

        if (!arquivos || arquivos.length === 0) {
          listaEl.innerHTML = "<li class='text-gray-500'>Nenhum arquivo disponível</li>";
          return;
        }

        listaEl.innerHTML = arquivos.map(a => `
          <li class="p-3 bg-white shadow rounded-lg">
            <a href="${a.url}" target="_blank" class="text-blue-600 hover:underline">
              📄 ${a.nome}
            </a>
          </li>
        `).join("");
      } catch (err) {
        listaEl.innerHTML = `<li class="text-red-600">❌ ${err.message}</li>`;
      }
    }

    function logout() {
      fetch("/logout", { method: "POST" })
        .then(() => {
          localStorage.clear();
          window.location.href = "/login.html";
        });
    }

    // Carrega arquivos ao abrir a página
    listarArquivos();
  </script>
</body>
</html>
